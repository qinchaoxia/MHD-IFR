import pandas as pd
import numpy as np

def precision(fin):
    df = pd.read_excel(fin)
    n = len(df)
    d1 = df.iloc[:].values
    c = 6
    t1 = [0] * c
    t2 = np.zeros((c, c))
    for i in range(n):
        if d1[i][0] == 0:
            t1[0] += 1
            if d1[i][1] == 1:
                t2[0][0] += 1
            if d1[i][1] == 2:
                t2[0][1] += 1
            if d1[i][1] == 3:
                t2[0][2] += 1
            if d1[i][1] == 4:
                t2[0][3] += 1
            if d1[i][1] == 5:
                t2[0][4] += 1
            if d1[i][1] == 6:
                t2[0][5] += 1
            '''
            if d1[i][1] == 7:
                t2[0][6] += 1

            if d1[i][1] == 8:
                t2[0][7] += 1
                '''
        if d1[i][0] == 1:
            t1[1] += 1
            if d1[i][1] == 1:
                t2[1][0] += 1
            if d1[i][1] == 2:
                t2[1][1] += 1
            if d1[i][1] == 3:
                t2[1][2] += 1
            if d1[i][1] == 4:
                t2[1][3] += 1
            if d1[i][1] == 5:
                t2[1][4] += 1
            if d1[i][1] == 6:
                t2[1][5] += 1
            '''
            if d1[i][1] == 7:
                t2[1][6] += 1

            if d1[i][1] == 8:
                t2[1][7] += 1
                '''
        if d1[i][0] == 2:
            t1[2] += 1
            if d1[i][1] == 1:
                t2[2][0] += 1
            if d1[i][1] == 2:
                t2[2][1] += 1
            if d1[i][1] == 3:
                t2[2][2] += 1
            if d1[i][1] == 4:
                t2[2][3] += 1
            if d1[i][1] == 5:
                t2[2][4] += 1
            if d1[i][1] == 6:
                t2[2][5] += 1
            '''
            if d1[i][1] == 7:
                t2[2][6] += 1

            if d1[i][1] == 8:
                t2[2][7] += 1
                '''
        if d1[i][0] == 3:
            t1[3] += 1
            if d1[i][1] == 1:
                t2[3][0] += 1
            if d1[i][1] == 2:
                t2[3][1] += 1
            if d1[i][1] == 3:
                t2[3][2] += 1
            if d1[i][1] == 4:
                t2[3][3] += 1
            if d1[i][1] == 5:
                t2[3][4] += 1
            if d1[i][1] == 6:
                t2[3][5] += 1
            '''
            if d1[i][1] == 7:
                t2[3][6] += 1

            if d1[i][1] == 8:
                t2[3][7] += 1
                '''
        if d1[i][0] == 4:
            t1[4] += 1
            if d1[i][1] == 1:
                t2[4][0] += 1
            if d1[i][1] == 2:
                t2[4][1] += 1
            if d1[i][1] == 3:
                t2[4][2] += 1
            if d1[i][1] == 4:
                t2[4][3] += 1
            if d1[i][1] == 5:
                t2[4][4] += 1
            if d1[i][1] == 6:
                t2[4][5] += 1
            '''
            if d1[i][1] == 7:
                t2[4][6] += 1

            if d1[i][1] == 8:
                t2[4][7] += 1
                '''
        if d1[i][0] == 5:
            t1[5]+=1
            if d1[i][1] == 1:
                t2[5][0] += 1
            if d1[i][1] == 2:
                t2[5][1] += 1
            if d1[i][1] == 3:
                t2[5][2] += 1
            if d1[i][1] == 4:
                t2[5][3] += 1
            if d1[i][1] == 5:
                t2[5][4] += 1
            if d1[i][1] == 6:
                t2[5][5] += 1
            '''
            if d1[i][1] == 7:
                t2[5][6] += 1

            if d1[i][1] == 8:
                t2[5][7] += 1


        if d1[i][0] == 6:
            t1[6]+=1
            if d1[i][1] == 1:
                t2[6][0] += 1
            if d1[i][1] == 2:
                t2[6][1] += 1
            if d1[i][1] == 3:
                t2[6][2] += 1
            if d1[i][1] == 4:
                t2[6][3] += 1
            if d1[i][1] == 5:
                t2[6][4] += 1
            if d1[i][1] == 6:
                t2[6][5] += 1
            if d1[i][1] == 7:
                t2[6][6] += 1

            if d1[i][1] == 8:
                t2[6][7] += 1

        if d1[i][0] == 7:
            t1[7]+=1
            if d1[i][1] == 1:
                t2[7][0] += 1
            if d1[i][1] == 2:
                t2[7][1] += 1
            if d1[i][1] == 3:
                t2[7][2] += 1
            if d1[i][1] == 4:
                t2[7][3] += 1
            if d1[i][1] == 5:
                t2[7][4] += 1
            if d1[i][1] == 6:
                t2[7][5] += 1
            if d1[i][1] == 7:
                t2[7][6] += 1
            if d1[i][1] == 8:
                t2[7][7] += 1
            '''

    p = 0
    cc = c
    for i in range(c):
        label = 0
        for j in range(c):
            if label <= t2[i][j]:
                label = t2[i][j]
        if t1[i]==0:
            p += 0
            cc -= 1
        else:
            p += label/t1[i]
        #print(label)
    print("the precision:{:.2f}%".format(100*p/cc))


if __name__ == "__main__":
    fin = "data/glass/data-S-Inv-labels.xls"
    precision(fin)

